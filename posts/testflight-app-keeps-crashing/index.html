<!DOCTYPE html><html lang="tw"><head><meta charset="UTF-8"/><meta name="og:site_name" content="李昇輯"/><link rel="canonical" href="http://localhost:8000/posts/testflight-app-keeps-crashing"/><meta name="twitter:url" content="http://localhost:8000/posts/testflight-app-keeps-crashing"/><meta name="og:url" content="http://localhost:8000/posts/testflight-app-keeps-crashing"/><title>TestFlight App 一直 Crash | 李昇輯</title><meta name="twitter:title" content="TestFlight App 一直 Crash | 李昇輯"/><meta name="og:title" content="TestFlight App 一直 Crash | 李昇輯"/><meta name="description" content="TestFlight app keeps crashing."/><meta name="twitter:description" content="TestFlight app keeps crashing."/><meta name="og:description" content="TestFlight app keeps crashing."/><meta name="twitter:card" content="summary"/><link rel="stylesheet" href="https://unpkg.com/purecss@1.0.1/build/base-min.css" type="text/css"/><link rel="stylesheet" href="https://unpkg.com/purecss@1.0.1/build/grids-responsive-min.css" type="text/css"/><link rel="stylesheet" href="/styles.css" type="text/css"/><link rel="stylesheet" href="/syntax.css" type="text/css"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/images/favicon.png" type="image/png"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to 李昇輯"/></head><body><div class="pure-g"><div class="sidebar pure-u-1 pure-u-md-1-5"><h1><a class="theme" href="/">李昇輯</a></h1><h2>iOS Developer</h2><p>Taipei, Taiwan</p><p><a class="theme" href="https://github.com/Jimmy-Lee">github</a></p><p><a class="theme" href="https://www.linkedin.com/in/%E6%98%87%E8%BC%AF-%E6%9D%8E-8a5340112/">linkedin</a></p><p><a class="theme" href="https://twitter.com/jimmy_prime">twitter</a></p><p><a class="theme" href="mailto:jimmylevelup@gmail.com">email</a></p></div><div class="content pure-u-1 pure-u-md-3-5"><h1>TestFlight App 一直 Crash</h1><tag><a href="/tags/ios">iOS</a></tag><tag><a href="/tags/testflight">TestFlight</a></tag><tag><a href="/tags/xcode">Xcode</a></tag><p class="date">2019-11-14</p><article><p>最近遇到神奇的 crash，QC 回報說登入按鈕一點就 crash。</p><p>經過漫長的測試和等待 TestFlight 處理之後，得到的結論是把 bitcode 關掉。</p><p>在蘋果的 <a href="https://help.apple.com/xcode/mac/current/#/devbbdc5ce4f">What is App Thinning?</a> 裡面有關 bitcode 的部分。</p><blockquote><p>“Bitcode is an intermediate representation of a compiled program. Apps you upload to App Store Connect that contain bitcode will be compiled and linked on the App Store. Including bitcode will allow Apple to re-optimize your app binary in the future without the need to submit a new version of your app to the App Store.”</p></blockquote><p>Apple 會在後台改你的 app，可能剛好遇到 Apple 演算法調整的更為激進，剛好就弄壞了。</p><p>這次找問題的過程中作得很混亂，覺得有一些可以改進的地方：</p><p><strong>測試的 build 應該另外開 branch。</strong>不要讓測試的暫時修改污染 master，尤其是 xcproj 裡面的 config 開開關關製造很多 commit 業障。</p><p><strong>從之前正常的 commit 重 build。</strong>先確認方法是正確的，再來做夾板測試，避免浪費時間作多餘的測試。</p><p><strong>確認環境沒有問題。</strong>這次遇到的問題是 Apple 出問題，平常根本不會去想他可能會壞掉，所以最後才懷疑到他身上。使用其他服務也是一樣，可以先驗證服務還是正確運作，而且驗證不需要花很多時間，又可以免掉後面的其他測試。</p><hr><p>後來又零星有遇到奇怪的 crash，進一步查資料後發現可能不是 bitcode 的問題，應該是 <a href="https://bugs.swift.org/browse/SR-11564">SR-11564</a> 這個 bug。</p><p>Xcode compiler 會太激進了，他把他看起來沒用到的 code 都刪掉了，runtime 就會找不到 symbol 而 crash。</p><p>目前的 workaround 方法是到 project settings 裡面把 <code>DEAD_CODE_STRIPPING </code> 設定成 <code>NO</code>。</p></article></div><footer><p>Generated using <a href="https://github.com/johnsundell/publish">Publish</a></p><p><a href="/feed.rss">RSS feed</a></p></footer></div></body></html>